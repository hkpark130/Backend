<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>신청 반려 안내</title>
    <style>
        body { font-family: "Noto Sans KR", Arial, sans-serif; background-color: #f6f7fb; margin: 0; padding: 24px; }
        .container { max-width: 680px; margin: 0 auto; background-color: #ffffff; border-radius: 8px; padding: 32px; box-shadow: 0 8px 24px rgba(15, 23, 42, 0.08); }
        h2 { margin-top: 0; color: #b91c1c; }
        p { line-height: 1.6; color: #374151; }
        .reason { margin: 18px 0; padding: 14px 16px; background-color: #fef2f2; border-radius: 6px; border-left: 4px solid #dc2626; color: #991b1b; }
        table { width: 100%; border-collapse: collapse; margin-top: 12px; }
        th, td { text-align: left; padding: 10px 12px; border-bottom: 1px solid #e5e7eb; font-size: 14px; }
        th { width: 28%; color: #6b7280; font-weight: 600; background-color: #f9fafb; }
        .cta { margin-top: 28px; display: inline-block; padding: 12px 18px; background-color: #1f2937; color: #ffffff; text-decoration: none; border-radius: 6px; }
    </style>
</head>
<body>
    <div class="container">
        <h2>신청이 반려되었습니다</h2>
        <p>[[${displayName}]] 님,</p>
        <p>아래 신청이 반려 처리되었습니다. 반려 사유를 확인한 뒤 필요 시 내용을 수정하여 다시 요청해 주세요.</p>
        <div class="reason">[[${rejectionReason}]]</div>
        <table>
            <tr><th>신청 번호</th><td>[[${approvalId}]]</td></tr>
            <tr><th>신청 구분</th><td>[[${actionName}]]</td></tr>
            <tr>
                <th>신청 장비</th>
                <td>
                    <span th:if="${deviceCount <= 1}">[[${deviceSummary}]]</span>
                    <ul th:if="${deviceCount > 1}" style="margin: 0; padding-left: 18px;">
                        <li th:each="deviceId : ${deviceIds}">[[${deviceId}]]</li>
                    </ul>
                </td>
            </tr>
            <tr><th>신청 사유</th><td>[[${reason}]]</td></tr>
            <tr><th>사용 기간</th><td>[[${usagePeriod}]]</td></tr>
            <tr><th>등록 일시</th><td>[[${submittedAt}]]</td></tr>
        </table>
        <div class="section" th:if="${hasDeviceDetails}">
            <h3>장비별 요청 내역</h3>
            <table>
                <thead>
                    <tr>
                        <th>관리번호</th>
                        <th>요청 프로젝트</th>
                        <th>요청 부서</th>
                        <th>요청 실사용자</th>
                        <th>입력 방식</th>
                        <th>현재 프로젝트</th>
                        <th>현재 부서</th>
                        <th>현재 실사용자</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="item : ${deviceDetails}">
                        <td>[[${item.deviceId}]]</td>
                        <td>
                            <span>[[${item.requestedProject}]]</span>
                            <span th:if="${item.requestedProjectCode}" style="color:#6b7280;">([[${item.requestedProjectCode}]])</span>
                        </td>
                        <td>[[${item.requestedDepartment}]]</td>
                        <td>[[${item.requestedRealUser}]]</td>
                        <td th:text="${item.requestedRealUserMode == 'manual' ? '직접 입력' : '자동'}">자동</td>
                        <td>[[${item.currentProject}]]</td>
                        <td>[[${item.currentDepartment}]]</td>
                        <td>[[${item.currentRealUser}]]</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <a class="cta" th:href="${link}" href="#" target="_blank" rel="noopener noreferrer">[[${linkLabel}]]</a>
    </div>
</body>
</html>
